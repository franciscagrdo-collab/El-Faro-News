<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>El Faro - Portada</title>
    <link rel="stylesheet" href="css/style.css">

    <style>
        /* Estilos para el contador de noticias */
        .news-counter {
            margin-left: auto;
            margin-right: 14px;
            text-decoration: none;
            color: #0b3d91;
            font-weight: 600;
            padding: 6px 8px;
            border-radius: 6px;
            display: inline-block;
            background: #fff;
            cursor: default;
            white-space: nowrap;
        }
    </style>
</head>
<body>
    <link rel="stylesheet" href="css/style.css">

    <header class="header" role="banner">
        <img src="media/logo.png" alt="El Faro - logo" class="logo"
             onerror="this.style.display='none'; document.getElementById('svgLogo').style.display='block'">
        <svg id="svgLogo" class="logo" viewBox="0 0 64 64" style="display:none" aria-hidden="true">
            <path d="M32 4 L36 20 H28 L32 4 Z" fill="#fff" />
            <rect x="22" y="20" width="20" height="36" rx="3" fill="#fff" />
            <circle cx="32" cy="30" r="3" fill="#0b3d91" />
            <rect x="6" y="56" width="52" height="2" fill="#0b3d91" />
        </svg>
        <div class="header-text">
            <h1>El Faro</h1>
            <p class="tagline">Noticias de Chile</p>
        </div>
    </header>

    <nav class="main-nav" role="navigation" aria-label="Menú principal">
        <a href="index.html" class="nav-link">Inicio</a>
        <a href="deporte.html" class="nav-link">Deporte</a>
        <a href="negocios.html" class="nav-link">Negocios</a>
        <a href="Nuevo.html" class="nav-link">Ayudanos a crecer</a>
        <span id="fecha-hora" class="nav-fecha"></span>
        <!-- Contador de noticias -->
        <span id="news-counter" class="news-counter">Noticias: 9</span>
        <script>
            function actualizarFechaHora() {
                const ahora = new Date();
                const opciones = {
                    weekday: 'long',
                    year: 'numeric',
                    month: 'long',
                    day: 'numeric',
                    hour: '2-digit',
                    minute: '2-digit',
                    second: '2-digit'
                };

                const fechaHora = ahora.toLocaleDateString('es-ES', opciones);
                document.getElementById('fecha-hora').textContent = fechaHora;
            }

            // Actualizar inmediatamente y cada segundo
            actualizarFechaHora();
            setInterval(actualizarFechaHora, 1000);
        </script>
    </nav>

    <main class="container" role="main">
        <section aria-labelledby="sec-principales" class="main-section">
            <div class="section-title"><h2 id="sec-principales">Noticias Principales (Chile)</h2></div>

            <!-- Tabla con 3 noticias chilenas -->
            <table class="table-news" aria-describedby="noticias-generales" id="articles-table">
                <thead>
                    <tr><th>Título</th><th>Categoría</th><th>Contenido / Fuente</th></tr>
                </thead>
                <tbody>
                    <tr>
                        <td>
                            <h3 class="article-title">
                                <a href="https://www.reuters.com/world/americas/chile-regulator-raises-bar-restart-parts-codelco-mine-after-collapse-2025-08-25/" target="_blank" rel="noopener noreferrer">
                                    Sernageomin exige más requisitos para reabrir zonas de El Teniente
                                </a>
                            </h3>
                        </td>
                        <td><span class="article-cat">Minería / Seguridad</span></td>
                        <td>
                            <div class="content-cell">
                                <img class="news-thumb" src="media/teniente.jpg" alt="El Teniente - referencia" onerror="this.classList.add('placeholder')">
                                <div>El regulador elevó condiciones para reanudar operaciones tras el derrumbe en El Teniente. <br><small class="small">Fuente: Reuters (enlace).</small></div>
                            </div>
                        </td>
                    </tr>

                    <tr>
                        <td>
                            <h3 class="article-title">
                                <a href="https://www.reuters.com/latam/negocio/7GBNTUYWLRIVVDSHRZ2AZUHBWA-2025-08-25/" target="_blank" rel="noopener noreferrer">
                                    Chile suspende importaciones avícolas desde Argentina por brote de gripe aviar
                                </a>
                            </h3>
                        </td>
                        <td><span class="article-cat">Salud Pública / Comercio</span></td>
                        <td>
                            <div class="content-cell">
                                <img class="news-thumb" src="media/avicola.jpg" alt="Brote gripe aviar - referencia" onerror="this.classList.add('placeholder')">
                                <div>El SAG anunció la medida para proteger estatus sanitario de aves en Chile. <br><small class="small">Fuente: Reuters.</small></div>
                            </div>
                        </td>
                    </tr>

                    <tr>
                        <td>
                            <h3 class="article-title">
                                <a href="https://www.reuters.com/latam/negocio/LA7VFZKJ5ZLCBPXXEHEIXN2Q5U-2025-08-01/" target="_blank" rel="noopener noreferrer">
                                    Imacec: actividad económica chilena creció 3,1% en junio
                                </a>
                            </h3>
                        </td>
                        <td><span class="article-cat">Economía</span></td>
                        <td>
                            <div class="content-cell">
                                <img class="news-thumb" src="media/imacec.jpg" alt="Imacec - referencia" onerror="this.classList.add('placeholder')">
                                <div>Banco Central informó crecimiento impulsado por servicios, comercio e industria. <br><small class="small">Fuente: Reuters / Banco Central.</small></div>
                            </div>
                        </td>
                    </tr>
                </tbody>
            </table>

           
            <div class="card media-card">
                <h3>Video destacado</h3>
                <video controls preload="metadata" poster="https://via.placeholder.com/1200x675.png?text=Video+poster">
                    <source src="media/general.mp4" type="video/mp4">
                    Tu navegador no soporta video. Mira la cobertura en YouTube
                    <a href="https://www.youtube.com/watch?v=fb7ISNhlRXo" target="_blank" rel="noopener noreferrer">aquí</a>.
                </video>
                <div class="iframe-wrap" aria-hidden="false">
                    <iframe src="https://www.youtube.com/embed/fb7ISNhlRXo" title="Cobertura El Teniente - 24Horas" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
                </div>
                <small class="small">Video: 24Horas / cobertura local.</small>
            </div>

            <div class="card">
                <h3>Audio / Podcast local</h3>
                <p>Podcast con análisis sobre El Teniente</p>
                <a class="button" href="https://envivo.adnradio.cl/audio/1754183680043/" target="_blank" rel="noopener noreferrer">Abrir podcast en ADN (nueva pestaña)</a>
                <p class="small" style="margin-top:8px;"></p>
            </div>

            <div class="card">
                <h2 class="contacto-titulo">Contáctanos</h2>
                <form id="formulario-contacto">
                    <div class="form-group">
                        <label class="form-label">Nombre <span class="required">*</span></label>
                        <input type="text" class="form-input" name="nombre" required placeholder="Nombre Apellido">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Email <span class="required">*</span></label>
                        <input type="text" class="form-input" name="email" required placeholder="email@ejemplo.com">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Teléfono</label>
                        <input type="text" class="form-input" name="telefono" placeholder="+569 1234 56789">
                    </div>
                    <div class="form-group">
                        <label class="form-label">Mensaje <span class="required">*</span></label>
                        <textarea class="form-textarea" name="mensaje" required placeholder="Escribenos..."></textarea>
                    </div>
                    <button type="submit" class="button">Enviar mensaje</button>
                    <div id="mensaje-alerta" class="form-mensaje"></div>
                </form>
            </div>
        </section>
    </main>

    <footer role="contentinfo">&copy; 2025 El Faro — Sitio de práctica educativo.</footer>

    <script>
        // Contador de noticias
        let newsCount = 9;

        // Actualizar contador de noticias
        function actualizarContadorNoticias() {
            document.getElementById('news-counter').textContent = `Noticias: ${newsCount}`;
        }

        // Cargar contador si existe en localStorage
        const storedCount = localStorage.getItem('newsCount');
        if (storedCount) {
            newsCount = parseInt(storedCount);
        }
        actualizarContadorNoticias();

        // Cargar y mostrar artículos de la categoría General
        function cargarArticulosGenerales() {
            const storedArticles = localStorage.getItem('newsArticles');
            if (!storedArticles) return;

            const articles = JSON.parse(storedArticles);
            const articlesTable = document.getElementById('articles-table');
            const tbody = articlesTable.querySelector('tbody');

            // Filtrar solo artículos de la categoría General (esto es lo único que cambia)
            const articulosGenerales = articles.filter(article => article.category === 'general');

            // Agregar los artículos generales al final de la tabla
            articulosGenerales.forEach(article => {
                const newRow = document.createElement('tr');

                newRow.innerHTML = `
              <td><h3 class="article-title"><a href="${article.link}" target="_blank" rel="noopener noreferrer">${article.title}</a></h3></td>
              <td><span class="article-cat">${getCategoryDisplayName(article.category)}</span></td>
              <td>
                <div class="content-cell">
                  ${article.image ?
                        `<img class="news-thumb" src="${article.image}" alt="${article.title}" onerror="this.classList.add('placeholder')">` :
                        `<div class="news-thumb placeholder">Sin imagen</div>`
                    }
                  <div>
                    ${article.description}
                    <br>
                    <small class="small">Fuente: ${article.source}</small>
                  </div>
                </div>
              </td>
            `;

                tbody.appendChild(newRow);
            });
        }

        function getCategoryDisplayName(category) {
            const categories = {
                'general': 'General',
                'negocios': 'Negocios',
                'deportes': 'Deportes'
            };
            return categories[category] || category;
        }


        // Formulario de contacto
        document.getElementById('formulario-contacto').addEventListener('submit', function (e) {
            e.preventDefault();
            const mensajeAlerta = document.getElementById('mensaje-alerta');

            setTimeout(() => {
                mensajeAlerta.textContent = '¡Mensaje enviado! Nuestro equipo se contactará contigo';
                mensajeAlerta.className = 'form-mensaje success';
                mensajeAlerta.style.display = 'block';
                this.reset();

                setTimeout(() => {
                    mensajeAlerta.style.display = 'none';
                }, 10000);
            }, 1000);
        });

        // Validación en tiempo real
        const inputs = document.querySelectorAll('.form-input, .form-textarea');
        inputs.forEach(input => {
            input.addEventListener('blur', function () {
                if (this.hasAttribute('required') && !this.value) {
                    this.style.borderColor = '#e53e3e';
                } else {
                    this.style.borderColor = '#e2e8f0';
                }
            });
        });

        // Navegación activa
        (function () {
            const links = document.querySelectorAll('.main-nav .nav-link');
            links.forEach(a => {
                const href = a.getAttribute('href');
                const page = location.pathname.split('/').pop() || 'index.html';
                if (href === page || (href === 'index.html' && (page === '' || page === 'index.html'))) {
                    a.classList.add('active');
                }
            });
        })();

        // Media helper
        (function () {
            document.querySelectorAll('.media-card').forEach(card => {
                const video = card.querySelector('video');
                const iframeWrap = card.querySelector('.iframe-wrap');
                if (!video || !iframeWrap) return;

                iframeWrap.style.display = 'none';
                let decided = false;

                function showVideo() {
                    if (decided) return;
                    decided = true;
                    video.style.display = '';
                    iframeWrap.style.display = 'none';
                }

                function showIframe() {
                    if (decided) return;
                    decided = true;
                    video.style.display = 'none';
                    iframeWrap.style.display = '';
                }

                video.addEventListener('loadedmetadata', showVideo);
                video.addEventListener('canplay', showVideo);
                video.addEventListener('error', showIframe);

                setTimeout(() => {
                    if (decided) return;
                    if (video.readyState > 0) showVideo();
                    else showIframe();
                }, 700);
            });
        })();

        // Cargar artículos al iniciar
        cargarArticulosGenerales();
    </script>
</body>
</html>